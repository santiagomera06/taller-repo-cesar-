<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Test</title>
</head>
<body>
  <article contenteditable="true"><p>One</p><p>Two</p><p>Three</p></article>
  <script src="./choice.min.js"></script>
  <script>
    /* global Choice */
    'use strict';

    var article = document.querySelector('article')

    var selection = new Choice(article, function () {
      return Array.prototype.slice.call(article.querySelectorAll('p'))
    })

    article.addEventListener('keydown', function (e) {
      if (e.keyCode === 'L'.charCodeAt(0) && !e.metaKey) {
        e.preventDefault()
        console.log(selection.getSelection())
      } else if (e.keyCode === 'B'.charCodeAt(0) && e.metaKey) {
        e.preventDefault()
        return document.execCommand('bold')
      }

      console.log('Changing...')
      selection.restore(selection.getSelection())
    })

    article.addEventListener('focus', function (e) {
      setTimeout(function () {
        var sel = selection.getSelection()
        console.log(sel)
        selection.restore(sel)
      }, 0)
    })

    article.addEventListener('mouseup', function (e) {
      var sel = selection.getSelection()
      console.log(sel)
      selection.restore(sel)
    })
  </script>
</body>
</html>
