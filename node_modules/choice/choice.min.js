(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.Choice=e()}})(function(){var e,t,n;return function i(e,t,n){function r(a,s){if(!t[a]){if(!e[a]){var u=typeof require=="function"&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var f=t[a]={exports:{}};e[a][0].call(f.exports,function(t){var n=e[a][1][t];return r(n?n:t)},f,f.exports,i,e,t,n)}return t[a].exports}var o=typeof require=="function"&&require;for(var a=0;a<n.length;a++)r(n[a]);return r}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(t,n,i){if(n)e(t.prototype,n);if(i)e(t,i);return t}}();function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=e("./encode");var s=r(a);var u=e("./decode");var l=r(u);var f=e("./selection");var d=r(f);var c=e("./utils");var h=r(c);var v=typeof window.getSelection().extend==="function";var p=function(){function e(t){var n=arguments.length<=1||arguments[1]===undefined?function(){return(0,h["default"])(t.childNodes)}:arguments[1];return function(){o(this,e);if(!t.contentEditable){throw TypeError("Choice requires a contentEditable element.")}this.elem=t;this._getChildren=n}.apply(this,arguments)}i(e,[{key:"getSelection",value:function t(){var e=window.getSelection();if(!e.rangeCount||document.activeElement!==this.elem){return null}var t=this._getChildren();var n=(0,s["default"])(t,e.anchorNode,e.anchorOffset);var i=null;if(e.isCollapsed){i=n}else if(n){i=(0,s["default"])(t,e.focusNode,e.focusOffset)}return n&&i?new d["default"](n,i):null}},{key:"restore",value:function n(e){var t=window.getSelection();if(!(e instanceof d["default"])){throw TypeError(e+" is not a valid selection.")}var n=this._getChildren();var i=undefined,r=undefined;if(e.isCollapsed){i=(0,l["default"])(n[e.end[0]],e.end[1])}else{i=(0,l["default"])(n[e.start[0]],e.start[1]);r=(0,l["default"])(n[e.end[0]],e.end[1])}this.elem.focus();var o=document.createRange();if(v){o.setStart(i.node,i.offset);o.setEnd(i.node,i.offset);t.removeAllRanges();t.addRange(o);if(r){t.extend(r.node,r.offset)}}else{r=r||i;if(e.isBackwards){var a=[r,i];i=a[0];r=a[1]}o.setStart(i.node,i.offset);o.setEnd(r.node,r.offset);t.removeAllRanges();t.addRange(o)}}}]);return e}();p.Selection=d["default"];p.Choice=p;n["default"]=p;t.exports=n["default"]},{"./decode":2,"./encode":3,"./selection":4,"./utils":5}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var i=e("./utils");function r(e,t){var n=e.firstChild;var r=0;while(n){if((0,i.isElem)(n)){if(n.nodeName==="BR"){if(!t){var o=n.parentNode;var a=(0,i.toArray)(o.childNodes);return{node:o,offset:a.indexOf(n)}}t-=1}if(!n.firstChild){while(!n.nextSibling){if(!r)break;r-=1;n=n.parentNode}n=n.nextSibling;continue}r+=1;n=n.firstChild;continue}if(t<=n.data.length){return{node:n,offset:t}}t-=n.data.length;while(!n.nextSibling){if(!r)break;r-=1;n=n.parentNode}n=n.nextSibling}throw RangeError("Invalid selection indices.")}n["default"]=r;t.exports=n["default"]},{"./utils":5}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var i=e("./utils");function r(e,t){while(t&&t!==e){if(t.nextSibling){return false}t=t.parentNode}return true}function o(e,t){var n=0;while(t&&t!==e){if(!t.previousSibling){t=t.parentNode;continue}t=t.previousSibling;while((0,i.isElem)(t)&&t.lastChild){t=t.lastChild}if((0,i.isText)(t)){n+=t.data.length}else if(t.nodeName==="BR"){n+=1}}return n}function a(e,t,n){var a=false;while(t){if((0,i.isText)(t)||t.nodeName==="BR"){break}else if(!t.isContentEditable){t=t.nextSibling}else if(n<t.childNodes.length){t=t.childNodes[n];n=0}else if(!t.childNodes.length){n=0;break}else{t=t.lastChild;if((0,i.isText)(t)){n=t.data.length}else if(t.nodeName==="BR"){n=1;a=true}else{n=t.childNodes.length}}}var s=t;var u=e.indexOf(s);while(u<0&&s.parentNode){s=s.parentNode;u=e.indexOf(s)}if(u<0)return null;if(a&&r(s,t)){n-=1}var l=o(s,t)+n;return[u,l]}n["default"]=a;t.exports=n["default"]},{"./utils":5}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(t,n,i){if(n)e(t.prototype,n);if(i)e(t,i);return t}}();function r(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var o=function(){function e(t){var n=arguments.length<=1||arguments[1]===undefined?t.slice():arguments[1];return function(){r(this,e);this.start=t;this.end=n}.apply(this,arguments)}i(e,[{key:"equals",value:function t(n){return n instanceof e&&this.start[0]===n.start[0]&&this.start[1]===n.start[1]&&this.end[0]===n.end[0]&&this.end[1]===n.end[1]}},{key:"clone",value:function n(){var e=this.constructor;return new e(this.start.slice(),this.end.slice())}},{key:"absoluteStart",get:function o(){return this.isBackwards?this.end:this.start}},{key:"absoluteEnd",get:function a(){return this.isBackwards?this.start:this.end}},{key:"isCollapsed",get:function s(){return this.start[0]===this.end[0]&&this.start[1]===this.end[1]}},{key:"isBackwards",get:function u(){return this.start[0]>this.end[0]||this.start[0]===this.end[0]&&this.start[1]>this.end[1]}}]);return e}();o.equals=function(e,t){if(!e||!t){return e===null&&t===null}return e instanceof o&&e.equals(t)};n["default"]=o;t.exports=n["default"]},{}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});n.toArray=i;n.isText=r;n.isElem=o;function i(e){return[].slice.call(e)}function r(e){return e&&e.nodeType===window.Node.TEXT_NODE}function o(e){return e&&e.nodeType===window.Node.ELEMENT_NODE}},{}]},{},[1])(1)});